nohup: ignoring input
/data/250010067/conda_envs/nmt_env/lib/python3.10/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Loading train.pt and valid.pt from data/processed_10k
Train samples: 9937, Valid samples: 486
Parameters: 191,726,472
Training transformer on cuda
/data/250010067/courses/NLP/NLP_midterm_project/train.py:72: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=self.use_amp):
Epoch 0 | Batch 0/311 | Loss: 8.6778
Epoch 0 | Batch 100/311 | Loss: 5.9242
Epoch 0 | Batch 200/311 | Loss: 5.7685
Epoch 0 | Batch 300/311 | Loss: 5.4315
/data/250010067/courses/NLP/NLP_midterm_project/train.py:113: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=self.use_amp):
Epoch 0 | Time: 135.4s | Train Loss: 5.9170 | Val Loss: 5.2491
New best model! Val Loss: 5.2491
Epoch 1 | Batch 0/311 | Loss: 5.4037
Epoch 1 | Batch 100/311 | Loss: 5.2288
Epoch 1 | Batch 200/311 | Loss: 5.1578
Epoch 1 | Batch 300/311 | Loss: 5.0347
Epoch 1 | Time: 116.8s | Train Loss: 5.2248 | Val Loss: 4.9563
New best model! Val Loss: 4.9563
Epoch 2 | Batch 0/311 | Loss: 5.0448
Epoch 2 | Batch 100/311 | Loss: 4.9263
Epoch 2 | Batch 200/311 | Loss: 4.8947
Epoch 2 | Batch 300/311 | Loss: 4.8777
Epoch 2 | Time: 124.2s | Train Loss: 4.8854 | Val Loss: 4.9003
New best model! Val Loss: 4.9003
Epoch 3 | Batch 0/311 | Loss: 4.5467
Epoch 3 | Batch 100/311 | Loss: 4.7321
Epoch 3 | Batch 200/311 | Loss: 4.6138
Epoch 3 | Batch 300/311 | Loss: 4.5106
Epoch 3 | Time: 120.0s | Train Loss: 4.6509 | Val Loss: 4.8637
New best model! Val Loss: 4.8637
Epoch 4 | Batch 0/311 | Loss: 4.4612
Epoch 4 | Batch 100/311 | Loss: 4.5171
Epoch 4 | Batch 200/311 | Loss: 4.3546
Epoch 4 | Batch 300/311 | Loss: 4.5768
Epoch 4 | Time: 123.3s | Train Loss: 4.4791 | Val Loss: 4.8883
Epoch 5 | Batch 0/311 | Loss: 4.2867
Epoch 5 | Batch 100/311 | Loss: 4.5243
Epoch 5 | Batch 200/311 | Loss: 4.3901
Epoch 5 | Batch 300/311 | Loss: 4.2837
Epoch 5 | Time: 118.0s | Train Loss: 4.3464 | Val Loss: 4.8394
New best model! Val Loss: 4.8394
Epoch 6 | Batch 0/311 | Loss: 4.1083
Epoch 6 | Batch 100/311 | Loss: 4.0494
Epoch 6 | Batch 200/311 | Loss: 4.1503
Epoch 6 | Batch 300/311 | Loss: 4.2684
Epoch 6 | Time: 117.9s | Train Loss: 4.2319 | Val Loss: 4.8333
New best model! Val Loss: 4.8333
Epoch 7 | Batch 0/311 | Loss: 4.0561
Epoch 7 | Batch 100/311 | Loss: 4.0653
Epoch 7 | Batch 200/311 | Loss: 4.0886
Epoch 7 | Batch 300/311 | Loss: 4.0960
Epoch 7 | Time: 111.4s | Train Loss: 4.1333 | Val Loss: 4.8849
Epoch 8 | Batch 0/311 | Loss: 3.9643
Epoch 8 | Batch 100/311 | Loss: 4.0244
Epoch 8 | Batch 200/311 | Loss: 3.9932
Epoch 8 | Batch 300/311 | Loss: 4.1603
Epoch 8 | Time: 101.6s | Train Loss: 4.0516 | Val Loss: 4.9047
Epoch 9 | Batch 0/311 | Loss: 4.0073
Epoch 9 | Batch 100/311 | Loss: 3.9181
Epoch 9 | Batch 200/311 | Loss: 4.0175
Epoch 9 | Batch 300/311 | Loss: 4.0402
Epoch 9 | Time: 102.3s | Train Loss: 3.9685 | Val Loss: 4.9746
Epoch 10 | Batch 0/311 | Loss: 3.8368
Epoch 10 | Batch 100/311 | Loss: 3.8753
Epoch 10 | Batch 200/311 | Loss: 3.8842
Epoch 10 | Batch 300/311 | Loss: 4.0285
Epoch 10 | Time: 86.9s | Train Loss: 3.9027 | Val Loss: 4.9921
Epoch 11 | Batch 0/311 | Loss: 3.6393
Epoch 11 | Batch 100/311 | Loss: 3.8811
Epoch 11 | Batch 200/311 | Loss: 3.7579
Epoch 11 | Batch 300/311 | Loss: 3.9164
Epoch 11 | Time: 89.4s | Train Loss: 3.8500 | Val Loss: 5.0413
Epoch 12 | Batch 0/311 | Loss: 3.6568
Epoch 12 | Batch 100/311 | Loss: 3.7541
Epoch 12 | Batch 200/311 | Loss: 3.8972
Epoch 12 | Batch 300/311 | Loss: 3.9227
Epoch 12 | Time: 83.9s | Train Loss: 3.8029 | Val Loss: 5.0700
Epoch 13 | Batch 0/311 | Loss: 3.6012
Epoch 13 | Batch 100/311 | Loss: 3.7440
Epoch 13 | Batch 200/311 | Loss: 3.7368
Epoch 13 | Batch 300/311 | Loss: 4.0424
Epoch 13 | Time: 84.0s | Train Loss: 3.7813 | Val Loss: 5.0876
Epoch 14 | Batch 0/311 | Loss: 3.6220
Epoch 14 | Batch 100/311 | Loss: 3.6209
Epoch 14 | Batch 200/311 | Loss: 3.6074
Epoch 14 | Batch 300/311 | Loss: 3.8315
Epoch 14 | Time: 84.1s | Train Loss: 3.7328 | Val Loss: 5.1244
Epoch 15 | Batch 0/311 | Loss: 3.5210
Epoch 15 | Batch 100/311 | Loss: 3.7481
Epoch 15 | Batch 200/311 | Loss: 3.7807
Epoch 15 | Batch 300/311 | Loss: 3.8857
Epoch 15 | Time: 82.3s | Train Loss: 3.7073 | Val Loss: 5.1781
Epoch 16 | Batch 0/311 | Loss: 3.5499
Epoch 16 | Batch 100/311 | Loss: 3.7552
Epoch 16 | Batch 200/311 | Loss: 3.6796
Epoch 16 | Batch 300/311 | Loss: 3.8113
Epoch 16 | Time: 84.5s | Train Loss: 3.6713 | Val Loss: 5.2106
Epoch 17 | Batch 0/311 | Loss: 3.6024
Epoch 17 | Batch 100/311 | Loss: 3.7580
Epoch 17 | Batch 200/311 | Loss: 3.7229
Epoch 17 | Batch 300/311 | Loss: 3.6679
Epoch 17 | Time: 84.0s | Train Loss: 3.6371 | Val Loss: 5.1991
Epoch 18 | Batch 0/311 | Loss: 3.4489
Epoch 18 | Batch 100/311 | Loss: 3.4859
Epoch 18 | Batch 200/311 | Loss: 3.5492
Epoch 18 | Batch 300/311 | Loss: 3.7011
Epoch 18 | Time: 84.8s | Train Loss: 3.5676 | Val Loss: 5.2691
Epoch 19 | Batch 0/311 | Loss: 3.3779
Epoch 19 | Batch 100/311 | Loss: 3.7245
Epoch 19 | Batch 200/311 | Loss: 3.4772
Epoch 19 | Batch 300/311 | Loss: 3.6081
Epoch 19 | Time: 84.0s | Train Loss: 3.5521 | Val Loss: 5.2727
Epoch 20 | Batch 0/311 | Loss: 3.5883
Epoch 20 | Batch 100/311 | Loss: 3.6195
Epoch 20 | Batch 200/311 | Loss: 3.4411
Epoch 20 | Batch 300/311 | Loss: 3.6600
Epoch 20 | Time: 85.9s | Train Loss: 3.5332 | Val Loss: 5.3042
Epoch 21 | Batch 0/311 | Loss: 3.3122
Epoch 21 | Batch 100/311 | Loss: 3.4022
Epoch 21 | Batch 200/311 | Loss: 3.4932
Epoch 21 | Batch 300/311 | Loss: 3.6828
Epoch 21 | Time: 83.8s | Train Loss: 3.4907 | Val Loss: 5.3616
Epoch 22 | Batch 0/311 | Loss: 3.3842
Epoch 22 | Batch 100/311 | Loss: 3.5157
Epoch 22 | Batch 200/311 | Loss: 3.6176
Epoch 22 | Batch 300/311 | Loss: 3.7118
Epoch 22 | Time: 58.0s | Train Loss: 3.4655 | Val Loss: 5.3875
Epoch 23 | Batch 0/311 | Loss: 3.2860
Epoch 23 | Batch 100/311 | Loss: 3.4145
Epoch 23 | Batch 200/311 | Loss: 3.4730
Epoch 23 | Batch 300/311 | Loss: 3.4821
Epoch 23 | Time: 39.8s | Train Loss: 3.4716 | Val Loss: 5.3806
Epoch 24 | Batch 0/311 | Loss: 3.1985
Epoch 24 | Batch 100/311 | Loss: 3.3700
Epoch 24 | Batch 200/311 | Loss: 3.5830
Epoch 24 | Batch 300/311 | Loss: 3.6193
Epoch 24 | Time: 54.7s | Train Loss: 3.4667 | Val Loss: 5.3891
Epoch 25 | Batch 0/311 | Loss: 3.3188
Epoch 25 | Batch 100/311 | Loss: 3.4651
Epoch 25 | Batch 200/311 | Loss: 3.4091
Epoch 25 | Batch 300/311 | Loss: 3.5260
Epoch 25 | Time: 63.9s | Train Loss: 3.4501 | Val Loss: 5.4257
Epoch 26 | Batch 0/311 | Loss: 3.4526
Epoch 26 | Batch 100/311 | Loss: 3.3629
Epoch 26 | Batch 200/311 | Loss: 3.5072
Epoch 26 | Batch 300/311 | Loss: 3.7912
Epoch 26 | Time: 38.8s | Train Loss: 3.4662 | Val Loss: 5.4442
Epoch 27 | Batch 0/311 | Loss: 3.2115
Epoch 27 | Batch 100/311 | Loss: 3.1738
Epoch 27 | Batch 200/311 | Loss: 3.6227
Epoch 27 | Batch 300/311 | Loss: 3.5712
Epoch 27 | Time: 28.4s | Train Loss: 3.4529 | Val Loss: 5.4885
Epoch 28 | Batch 0/311 | Loss: 3.2434
Epoch 28 | Batch 100/311 | Loss: 3.4467
Epoch 28 | Batch 200/311 | Loss: 3.3658
Epoch 28 | Batch 300/311 | Loss: 3.5522
Epoch 28 | Time: 28.3s | Train Loss: 3.4760 | Val Loss: 5.4940
Epoch 29 | Batch 0/311 | Loss: 3.2500
Epoch 29 | Batch 100/311 | Loss: 3.4052
Epoch 29 | Batch 200/311 | Loss: 3.3892
Epoch 29 | Batch 300/311 | Loss: 3.5294
Epoch 29 | Time: 28.1s | Train Loss: 3.4419 | Val Loss: 5.4933
Epoch 30 | Batch 0/311 | Loss: 3.3428
Epoch 30 | Batch 100/311 | Loss: 3.3403
Epoch 30 | Batch 200/311 | Loss: 3.5217
Epoch 30 | Batch 300/311 | Loss: 3.5823
Epoch 30 | Time: 28.5s | Train Loss: 3.4563 | Val Loss: 5.5455
Epoch 31 | Batch 0/311 | Loss: 3.3944
Epoch 31 | Batch 100/311 | Loss: 3.3799
Epoch 31 | Batch 200/311 | Loss: 3.4033
Epoch 31 | Batch 300/311 | Loss: 3.4982
Epoch 31 | Time: 29.0s | Train Loss: 3.4435 | Val Loss: 5.5537
Epoch 32 | Batch 0/311 | Loss: 3.2322
Epoch 32 | Batch 100/311 | Loss: 3.3043
Epoch 32 | Batch 200/311 | Loss: 3.3969
Epoch 32 | Batch 300/311 | Loss: 3.4931
Epoch 32 | Time: 18.9s | Train Loss: 3.4224 | Val Loss: 5.5477
Epoch 33 | Batch 0/311 | Loss: 3.2434
Epoch 33 | Batch 100/311 | Loss: 3.4320
Epoch 33 | Batch 200/311 | Loss: 3.4300
Epoch 33 | Batch 300/311 | Loss: 3.4935
Epoch 33 | Time: 19.3s | Train Loss: 3.3918 | Val Loss: 5.6141
Epoch 34 | Batch 0/311 | Loss: 3.0577
Epoch 34 | Batch 100/311 | Loss: 3.3652
Epoch 34 | Batch 200/311 | Loss: 3.5425
Epoch 34 | Batch 300/311 | Loss: 3.4478
Epoch 34 | Time: 20.6s | Train Loss: 3.3928 | Val Loss: 5.6037
Epoch 35 | Batch 0/311 | Loss: 3.3891
Epoch 35 | Batch 100/311 | Loss: 3.3364
Epoch 35 | Batch 200/311 | Loss: 3.4527
Epoch 35 | Batch 300/311 | Loss: 3.4899
Epoch 35 | Time: 19.6s | Train Loss: 3.4251 | Val Loss: 5.6016
Epoch 36 | Batch 0/311 | Loss: 3.3122
Epoch 36 | Batch 100/311 | Loss: 3.3469
Epoch 36 | Batch 200/311 | Loss: 3.4795
Epoch 36 | Batch 300/311 | Loss: 3.4680
Epoch 36 | Time: 19.1s | Train Loss: 3.4407 | Val Loss: 5.6352
Epoch 37 | Batch 0/311 | Loss: 3.2937
Epoch 37 | Batch 100/311 | Loss: 3.4227
Epoch 37 | Batch 200/311 | Loss: 3.5576
Epoch 37 | Batch 300/311 | Loss: 3.5197
Epoch 37 | Time: 19.1s | Train Loss: 3.4368 | Val Loss: 5.6482
Epoch 38 | Batch 0/311 | Loss: 3.3296
Epoch 38 | Batch 100/311 | Loss: 3.4361
Epoch 38 | Batch 200/311 | Loss: 3.3512
Epoch 38 | Batch 300/311 | Loss: 3.6555
Epoch 38 | Time: 19.3s | Train Loss: 3.4693 | Val Loss: 5.7623
Epoch 39 | Batch 0/311 | Loss: 3.2546
Epoch 39 | Batch 100/311 | Loss: 3.2824
Epoch 39 | Batch 200/311 | Loss: 3.4771
Epoch 39 | Batch 300/311 | Loss: 3.6705
Epoch 39 | Time: 19.1s | Train Loss: 3.4254 | Val Loss: 5.7110

Total training time: 01:05:05 (3906.0s)
