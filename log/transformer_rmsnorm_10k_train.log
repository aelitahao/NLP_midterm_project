nohup: ignoring input
/data/250010067/conda_envs/nmt_env/lib/python3.10/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
Loading train.pt and valid.pt from data/processed_10k
Train samples: 9937, Valid samples: 486
Parameters: 7,529,352
Training transformer on cuda
/data/250010067/courses/NLP/NLP_midterm_project/train.py:72: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=self.use_amp):
Epoch 0 | Batch 0/311 | Loss: 8.6306
Epoch 0 | Batch 100/311 | Loss: 7.0338
Epoch 0 | Batch 200/311 | Loss: 6.0041
Epoch 0 | Batch 300/311 | Loss: 5.6540
/data/250010067/courses/NLP/NLP_midterm_project/train.py:113: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=self.use_amp):
Epoch 0 | Time: 15.3s | Train Loss: 6.6522 | Val Loss: 5.5035
New best model! Val Loss: 5.5035
Epoch 1 | Batch 0/311 | Loss: 5.7974
Epoch 1 | Batch 100/311 | Loss: 5.5507
Epoch 1 | Batch 200/311 | Loss: 5.3070
Epoch 1 | Batch 300/311 | Loss: 5.3568
Epoch 1 | Time: 23.6s | Train Loss: 5.4635 | Val Loss: 5.0450
New best model! Val Loss: 5.0450
Epoch 2 | Batch 0/311 | Loss: 5.1899
Epoch 2 | Batch 100/311 | Loss: 5.2102
Epoch 2 | Batch 200/311 | Loss: 4.9991
Epoch 2 | Batch 300/311 | Loss: 4.8324
Epoch 2 | Time: 28.4s | Train Loss: 5.0014 | Val Loss: 4.8415
New best model! Val Loss: 4.8415
Epoch 3 | Batch 0/311 | Loss: 4.7942
Epoch 3 | Batch 100/311 | Loss: 4.5881
Epoch 3 | Batch 200/311 | Loss: 4.6520
Epoch 3 | Batch 300/311 | Loss: 4.5959
Epoch 3 | Time: 32.6s | Train Loss: 4.7039 | Val Loss: 4.8081
New best model! Val Loss: 4.8081
Epoch 4 | Batch 0/311 | Loss: 4.5652
Epoch 4 | Batch 100/311 | Loss: 4.5564
Epoch 4 | Batch 200/311 | Loss: 4.2633
Epoch 4 | Batch 300/311 | Loss: 4.5188
Epoch 4 | Time: 31.2s | Train Loss: 4.4606 | Val Loss: 4.7615
New best model! Val Loss: 4.7615
Epoch 5 | Batch 0/311 | Loss: 4.3080
Epoch 5 | Batch 100/311 | Loss: 4.3137
Epoch 5 | Batch 200/311 | Loss: 4.3649
Epoch 5 | Batch 300/311 | Loss: 4.3617
Epoch 5 | Time: 16.2s | Train Loss: 4.2429 | Val Loss: 4.7125
New best model! Val Loss: 4.7125
Epoch 6 | Batch 0/311 | Loss: 4.1224
Epoch 6 | Batch 100/311 | Loss: 4.1942
Epoch 6 | Batch 200/311 | Loss: 4.0052
Epoch 6 | Batch 300/311 | Loss: 3.9449
Epoch 6 | Time: 10.7s | Train Loss: 4.0430 | Val Loss: 4.6978
New best model! Val Loss: 4.6978
Epoch 7 | Batch 0/311 | Loss: 3.8092
Epoch 7 | Batch 100/311 | Loss: 3.8585
Epoch 7 | Batch 200/311 | Loss: 3.8959
Epoch 7 | Batch 300/311 | Loss: 3.9232
Epoch 7 | Time: 9.1s | Train Loss: 3.8675 | Val Loss: 4.7029
Epoch 8 | Batch 0/311 | Loss: 3.6431
Epoch 8 | Batch 100/311 | Loss: 3.4833
Epoch 8 | Batch 200/311 | Loss: 3.8522
Epoch 8 | Batch 300/311 | Loss: 3.7472
Epoch 8 | Time: 8.6s | Train Loss: 3.7086 | Val Loss: 4.7091
Epoch 9 | Batch 0/311 | Loss: 3.5260
Epoch 9 | Batch 100/311 | Loss: 3.3927
Epoch 9 | Batch 200/311 | Loss: 3.5174
Epoch 9 | Batch 300/311 | Loss: 3.6089
Epoch 9 | Time: 6.2s | Train Loss: 3.5606 | Val Loss: 4.7385
Epoch 10 | Batch 0/311 | Loss: 3.3387
Epoch 10 | Batch 100/311 | Loss: 3.4171
Epoch 10 | Batch 200/311 | Loss: 3.4374
Epoch 10 | Batch 300/311 | Loss: 3.3756
Epoch 10 | Time: 5.1s | Train Loss: 3.4250 | Val Loss: 4.7851
Epoch 11 | Batch 0/311 | Loss: 3.1215
Epoch 11 | Batch 100/311 | Loss: 3.2117
Epoch 11 | Batch 200/311 | Loss: 3.3430
Epoch 11 | Batch 300/311 | Loss: 3.3037
Epoch 11 | Time: 6.2s | Train Loss: 3.2967 | Val Loss: 4.8323
Epoch 12 | Batch 0/311 | Loss: 3.1030
Epoch 12 | Batch 100/311 | Loss: 2.9616
Epoch 12 | Batch 200/311 | Loss: 3.1712
Epoch 12 | Batch 300/311 | Loss: 3.2221
Epoch 12 | Time: 7.5s | Train Loss: 3.1816 | Val Loss: 4.8743
Epoch 13 | Batch 0/311 | Loss: 2.8431
Epoch 13 | Batch 100/311 | Loss: 3.1279
Epoch 13 | Batch 200/311 | Loss: 3.1586
Epoch 13 | Batch 300/311 | Loss: 3.1389
Epoch 13 | Time: 7.6s | Train Loss: 3.0720 | Val Loss: 4.8847
Epoch 14 | Batch 0/311 | Loss: 2.9703
Epoch 14 | Batch 100/311 | Loss: 2.7829
Epoch 14 | Batch 200/311 | Loss: 3.0191
Epoch 14 | Batch 300/311 | Loss: 2.8924
Epoch 14 | Time: 7.6s | Train Loss: 2.9695 | Val Loss: 4.9573
Epoch 15 | Batch 0/311 | Loss: 2.7214
Epoch 15 | Batch 100/311 | Loss: 2.7806
Epoch 15 | Batch 200/311 | Loss: 2.9240
Epoch 15 | Batch 300/311 | Loss: 2.8575
Epoch 15 | Time: 5.1s | Train Loss: 2.8740 | Val Loss: 4.9822
Epoch 16 | Batch 0/311 | Loss: 2.7883
Epoch 16 | Batch 100/311 | Loss: 2.7249
Epoch 16 | Batch 200/311 | Loss: 2.6416
Epoch 16 | Batch 300/311 | Loss: 2.9001
Epoch 16 | Time: 5.1s | Train Loss: 2.7867 | Val Loss: 5.0583
Epoch 17 | Batch 0/311 | Loss: 2.6371
Epoch 17 | Batch 100/311 | Loss: 2.5292
Epoch 17 | Batch 200/311 | Loss: 2.9023
Epoch 17 | Batch 300/311 | Loss: 2.7240
Epoch 17 | Time: 6.2s | Train Loss: 2.7012 | Val Loss: 5.0971
Epoch 18 | Batch 0/311 | Loss: 2.5147
Epoch 18 | Batch 100/311 | Loss: 2.5590
Epoch 18 | Batch 200/311 | Loss: 2.7831
Epoch 18 | Batch 300/311 | Loss: 2.9281
Epoch 18 | Time: 7.4s | Train Loss: 2.6272 | Val Loss: 5.1333
Epoch 19 | Batch 0/311 | Loss: 2.3101
Epoch 19 | Batch 100/311 | Loss: 2.4466
Epoch 19 | Batch 200/311 | Loss: 2.5561
Epoch 19 | Batch 300/311 | Loss: 2.6712
Epoch 19 | Time: 7.5s | Train Loss: 2.5553 | Val Loss: 5.1539
Epoch 20 | Batch 0/311 | Loss: 2.3979
Epoch 20 | Batch 100/311 | Loss: 2.3419
Epoch 20 | Batch 200/311 | Loss: 2.4563
Epoch 20 | Batch 300/311 | Loss: 2.7158
Epoch 20 | Time: 7.3s | Train Loss: 2.4928 | Val Loss: 5.1703
Epoch 21 | Batch 0/311 | Loss: 2.3628
Epoch 21 | Batch 100/311 | Loss: 2.3357
Epoch 21 | Batch 200/311 | Loss: 2.4250
Epoch 21 | Batch 300/311 | Loss: 2.4475
Epoch 21 | Time: 5.0s | Train Loss: 2.4275 | Val Loss: 5.2195
Epoch 22 | Batch 0/311 | Loss: 2.0236
Epoch 22 | Batch 100/311 | Loss: 2.2798
Epoch 22 | Batch 200/311 | Loss: 2.4340
Epoch 22 | Batch 300/311 | Loss: 2.5850
Epoch 22 | Time: 5.7s | Train Loss: 2.3692 | Val Loss: 5.2691
Epoch 23 | Batch 0/311 | Loss: 2.1447
Epoch 23 | Batch 100/311 | Loss: 2.2227
Epoch 23 | Batch 200/311 | Loss: 2.3583
Epoch 23 | Batch 300/311 | Loss: 2.4452
Epoch 23 | Time: 7.7s | Train Loss: 2.3171 | Val Loss: 5.2854
Epoch 24 | Batch 0/311 | Loss: 1.9488
Epoch 24 | Batch 100/311 | Loss: 2.1013
Epoch 24 | Batch 200/311 | Loss: 2.4062
Epoch 24 | Batch 300/311 | Loss: 2.3496
Epoch 24 | Time: 7.6s | Train Loss: 2.2623 | Val Loss: 5.3191
Epoch 25 | Batch 0/311 | Loss: 2.1775
Epoch 25 | Batch 100/311 | Loss: 2.2251
Epoch 25 | Batch 200/311 | Loss: 2.1894
Epoch 25 | Batch 300/311 | Loss: 2.3279
Epoch 25 | Time: 7.7s | Train Loss: 2.2109 | Val Loss: 5.4019
Epoch 26 | Batch 0/311 | Loss: 1.9283
Epoch 26 | Batch 100/311 | Loss: 2.1481
Epoch 26 | Batch 200/311 | Loss: 2.0767
Epoch 26 | Batch 300/311 | Loss: 2.3393
Epoch 26 | Time: 5.2s | Train Loss: 2.1670 | Val Loss: 5.4538
Epoch 27 | Batch 0/311 | Loss: 2.0856
Epoch 27 | Batch 100/311 | Loss: 2.0674
Epoch 27 | Batch 200/311 | Loss: 2.1458
Epoch 27 | Batch 300/311 | Loss: 2.4435
Epoch 27 | Time: 5.1s | Train Loss: 2.1257 | Val Loss: 5.4822
Epoch 28 | Batch 0/311 | Loss: 1.9727
Epoch 28 | Batch 100/311 | Loss: 2.0330
Epoch 28 | Batch 200/311 | Loss: 2.1287
Epoch 28 | Batch 300/311 | Loss: 2.1418
Epoch 28 | Time: 5.1s | Train Loss: 2.0768 | Val Loss: 5.4854
Epoch 29 | Batch 0/311 | Loss: 2.0242
Epoch 29 | Batch 100/311 | Loss: 1.7805
Epoch 29 | Batch 200/311 | Loss: 1.9793
Epoch 29 | Batch 300/311 | Loss: 2.1816
Epoch 29 | Time: 5.1s | Train Loss: 2.0471 | Val Loss: 5.5489
Epoch 30 | Batch 0/311 | Loss: 1.9909
Epoch 30 | Batch 100/311 | Loss: 1.8951
Epoch 30 | Batch 200/311 | Loss: 2.0079
Epoch 30 | Batch 300/311 | Loss: 2.0725
Epoch 30 | Time: 6.5s | Train Loss: 2.0083 | Val Loss: 5.6153
Epoch 31 | Batch 0/311 | Loss: 1.8544
Epoch 31 | Batch 100/311 | Loss: 2.0025
Epoch 31 | Batch 200/311 | Loss: 2.0497
Epoch 31 | Batch 300/311 | Loss: 2.0857
Epoch 31 | Time: 7.6s | Train Loss: 1.9702 | Val Loss: 5.6623
Epoch 32 | Batch 0/311 | Loss: 1.7845
Epoch 32 | Batch 100/311 | Loss: 1.9360
Epoch 32 | Batch 200/311 | Loss: 1.9134
Epoch 32 | Batch 300/311 | Loss: 1.9780
Epoch 32 | Time: 7.6s | Train Loss: 1.9369 | Val Loss: 5.6889
Epoch 33 | Batch 0/311 | Loss: 1.8093
Epoch 33 | Batch 100/311 | Loss: 1.7898
Epoch 33 | Batch 200/311 | Loss: 1.9462
Epoch 33 | Batch 300/311 | Loss: 1.9211
Epoch 33 | Time: 8.0s | Train Loss: 1.9089 | Val Loss: 5.7364
Epoch 34 | Batch 0/311 | Loss: 1.8258
Epoch 34 | Batch 100/311 | Loss: 1.7577
Epoch 34 | Batch 200/311 | Loss: 1.7850
Epoch 34 | Batch 300/311 | Loss: 1.9631
Epoch 34 | Time: 5.4s | Train Loss: 1.8707 | Val Loss: 5.8105
Epoch 35 | Batch 0/311 | Loss: 1.7736
Epoch 35 | Batch 100/311 | Loss: 1.8571
Epoch 35 | Batch 200/311 | Loss: 1.9488
Epoch 35 | Batch 300/311 | Loss: 1.9813
Epoch 35 | Time: 6.9s | Train Loss: 1.8431 | Val Loss: 5.7945
Epoch 36 | Batch 0/311 | Loss: 1.8184
Epoch 36 | Batch 100/311 | Loss: 1.8275
Epoch 36 | Batch 200/311 | Loss: 1.8438
Epoch 36 | Batch 300/311 | Loss: 1.8707
Epoch 36 | Time: 8.0s | Train Loss: 1.8212 | Val Loss: 5.8085
Epoch 37 | Batch 0/311 | Loss: 1.7789
Epoch 37 | Batch 100/311 | Loss: 1.7040
Epoch 37 | Batch 200/311 | Loss: 1.8379
Epoch 37 | Batch 300/311 | Loss: 1.9098
Epoch 37 | Time: 7.4s | Train Loss: 1.7950 | Val Loss: 5.8470
Epoch 38 | Batch 0/311 | Loss: 1.5936
Epoch 38 | Batch 100/311 | Loss: 1.7093
Epoch 38 | Batch 200/311 | Loss: 1.8459
Epoch 38 | Batch 300/311 | Loss: 1.9773
Epoch 38 | Time: 7.4s | Train Loss: 1.7664 | Val Loss: 5.9445
Epoch 39 | Batch 0/311 | Loss: 1.5426
Epoch 39 | Batch 100/311 | Loss: 1.7819
Epoch 39 | Batch 200/311 | Loss: 1.8573
Epoch 39 | Batch 300/311 | Loss: 1.8483
Epoch 39 | Time: 4.8s | Train Loss: 1.7420 | Val Loss: 5.9463

Total training time: 00:06:56 (416.9s)
